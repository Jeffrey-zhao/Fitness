
@{
  ViewBag.Title = "Role | Add";
}
@model Fit.DTO.RBAC.PermissionDTO[]

<div class="row">
  <div class="col-sm-12">
    <div class="ibox float-e-margins">
      <div class="ibox-content">
        <form class="m-t" role="form" id="formAdd">
          <div class="form-group">
            <label>名称</label>
            <input type="text" class="form-control" name="Name" required="" pattern="^[0-9a-zA-Z.]+" title="只能输入字母，数字和“.”">
          </div>
          <div class="form-group">
            <label>描述</label>
            <input type="text" class="form-control" name="Description">
          </div>
          <div class="hr-line-dashed"></div>
          <div class="form-group">
            <label>权限设置</label>
            <div class="row">
              @{
                if (Model.Length <= 0)
                {
                  return;
                }
                for (int i = 1; i <= Model.Length; i++)
                {
                  <div class="col-sm-4">
                    <label class="checkbox-inline i-checks">
                      <input type="checkbox" name="PermissionIDs" value="@Model[i-1].Id">
                      <span>&nbsp;</span><strong>@Model[i - 1].Name</strong>
                    </label>
                  </div>
                  if (i % 3 == 0)
                  {
                    @Html.Raw(@"</div><br /><div class='row'>");
                  }
                }
              }
            </div>
          </div>
          <input id="btnSave" type="submit" class="btn btn-primary block full-width m-b" value="保存">
        </form>
      </div>
    </div>
  </div>
</div>

@section FooterScript{
  <script type="text/javascript" src="~/Scripts/jquery-1.10.2.min.js"></script>
  <!-- iCheck -->
  <script src="~/Scripts/plugins/iCheck/icheck.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('.i-checks').iCheck({
        checkboxClass: 'icheckbox_square-green',
        radioClass: 'iradio_square-green',
      });
    });

    var options = {
      success: function (response) {
        execResponse(response);
      },
      url: "/Role/Add",
      type: "post"
    };

    $("#formAdd").submit(function () {
      $(this).ajaxSubmit(options);
      return false;
    });

    function execResponse(res) {
      if (res.status == "ok") {
        location.href = "/Role/List";
      } else {
        alert(res.msg);
      }
    }
  </script>
}
